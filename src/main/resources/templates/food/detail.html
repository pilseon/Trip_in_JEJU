<!DOCTYPE html>
<html layout:decorate="~{layout/layout}">
<section layout:fragment="content" class="section-prod-list">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport"
              content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        <link href="/resource/css/like.css" rel="stylesheet" type="text/css"/>
        <link href="/resource/css/click.css" rel="stylesheet" type="text/css"/>
        <title>test</title>
    </head>
    <body>
    <section class="container mt-1">
        <!-- ÎÇ¥Ïö©  -->
        <!-- Ïù¥ÎØ∏ÏßÄÏôÄ Ï¢ãÏïÑÏöî Î≤ÑÌäºÏùÑ Í∞êÏã∏Îäî Ïª®ÌÖåÏù¥ÎÑà Ï∂îÍ∞Ä -->
        <div class="image-container">
            <img class="w-full" style="width: 100%; max-width: 100%;" th:src="@{|/gen/${food.thumbnailImg}|}" alt="ÏÉÅÌíàÏù¥ÎØ∏ÏßÄ">
            <div class="like-button-container" id="likeButtonContainer">
                <form id="likeForm" th:action="@{/food/like/{id}(id=${food.id})}" method="post" style="display: inline;">
                    <button type="submit" th:disabled="${alreadyLiked}">‚ù§Ô∏è</button>
                </form>
                <span class="likes" th:text="'(' + ${food.likes} + ')'"> (0) </span>
            </div>
        </div>
        <!-- ÎÇ¥Ïö© -->
        <div class="card">
            <div class="card-body">
                <span class="font-bold" style="font-size: 1.5rem;" th:text="${food.title}"></span>
                <ul class="list-group list-group-flush">
                    <li class="list-group-item">
                        <span style="font-weight: bold;">ÏòÅÏóÖÏãúÍ∞Ñ: </span>
                        <span th:text="${#temporals.format(food.calendar.businessHoursStart, 'HH:mm')}"></span>
                        <span> ~ </span>
                        <span th:text="${#temporals.format(food.calendar.businessHoursEnd, 'HH:mm')}"></span>
                    </li>
                    <li class="list-group-item">
                        <span style="font-weight: bold;">Ìú¥Î¨¥Ïùº: </span>
                        <span th:text="${food.calendar.closedDay}"></span>
                    </li>
                    <li class="list-group-item">
                        <span style="font-weight: bold;">ÏúÑÏπò : </span>
                        <span th:text="${food.location.name}"></span>
                        <br>
                    </li>
                    <li class="list-group-item">
                        <span style="font-weight: bold;">Ï†ïÎ≥¥: </span>
                        <a th:href="${food.websiteUrl}" target="_blank" style="color: blue;">ÌôàÌéòÏù¥ÏßÄ</a>
                    </li>
                    <li class="list-group-item">
                        <span style="font-weight: bold;">Î≤àÌò∏: </span>
                        <span th:text="${food.phoneNumber}"></span>
                    </li>
                </ul>
                <!-- Ìï¥ÏãúÌÉúÍ∑∏ -->
                <div class="mt-4">
                    <span th:text="${food.hashtags}"></span>
                </div>

                <div class="mt-4">
                    <span>
                        <a th:href="@{/food/review/{id}(id=${food.id})}" style="font-size: 1.5rem;">
                            ‚≠ê <span th:text="${averageScore}">4.9</span> Î¶¨Î∑∞ (<span th:text="${ratings.size()}">999+</span>)
                        </a>
                    </span>
                </div>

                <!-- ÎÇ¥Ïö© -->
                <div class="mt-4">
                    <span th:text="${food.content}"></span>
                </div>

                <div sec:authorize="isAuthenticated()" th:if="${#authorization.expression('hasAuthority(''ADMIN'')')}">
                    <form th:action="@{/food/delete/{id}(id=${food.id})}" method="post" style="display:inline;"
                          onsubmit="return confirm('Ï†ïÎßê ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?');">
                        <input type="hidden" name="_method" value="delete"/>
                        <button type="submit" class="delete-button">
                            <i class="fas fa-trash-alt"></i> ÏÇ≠Ï†ú
                        </button>
                    </form>
                </div>

                <div class="scrap-button-container mt-4" id="scrapButtonContainer">
                    <form id="scrapForm" th:action="@{/food/scrap/{id}(id=${food.id})}" method="post" style="display: inline;">
                        <button type="submit" th:disabled="${alreadyScrapped}">üìå</button>
                    </form>
                    <span class="scraps" th:text="'(' + ${food.scrapCount} + ')'"> (0) </span>
                </div>


                <!-- ÏßÄÎèÑ  -->
                <div class="mt-4">
                    <span class="font-bold" style="font-size: 1.5rem;">ÏßÄÎèÑ </span>
                    <div id="map" th:data-latitude="${food.location.latitude}" th:data-longitude="${food.location.longitude}" style="width:100%;height:400px;"></div>
                </div>
            </div>
        </div>
    </section>

    <script th:inline="javascript" th:src="@{/detailjs/detail.js}"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const likeButtonContainer = document.getElementById('likeButtonContainer');
            const likeForm = document.getElementById('likeForm');
            const scrapButtonContainer = document.getElementById('scrapButtonContainer');
            const scrapForm = document.getElementById('scrapForm');

            likeButtonContainer.addEventListener('click', function () {
                likeForm.submit();
            });

            scrapButtonContainer.addEventListener('click', function () {
                scrapForm.submit();
            });
        });
    </script>
    </body>
</section>
</html>
